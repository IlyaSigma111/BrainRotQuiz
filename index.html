<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–û–ì–≠ –ö–ê–•–£–¢ - –ì–ª–∞–≤–Ω–∞—è</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <style>
        /* –ú–û–ë–ò–õ–¨–ù–ê–Ø –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø */
        @media (max-width: 768px) {
            .home-header h1 {
                font-size: 28px !important;
            }
            
            .subtitle {
                font-size: 14px !important;
                padding: 0 10px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr !important;
                gap: 15px !important;
                padding: 0 10px;
            }
            
            .role-selection {
                grid-template-columns: 1fr !important;
                padding: 0 10px;
            }
            
            .role-card {
                padding: 20px !important;
            }
            
            .steps {
                grid-template-columns: 1fr !important;
            }
            
            .step {
                margin-bottom: 15px;
            }
            
            .home-footer {
                padding: 20px 15px !important;
                font-size: 12px;
            }
            
            .tech-stack {
                flex-wrap: wrap;
                gap: 8px;
            }
            
            .tech-item {
                font-size: 11px;
                padding: 4px 8px;
            }
            
            /* –£–ª—É—á—à–∞–µ–º –∫–Ω–æ–ø–∫–∏ –¥–ª—è –∫–∞—Å–∞–Ω–∏–π */
            .btn {
                padding: 14px !important;
                font-size: 16px !important;
                min-height: 50px;
            }
            
            /* –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –æ–±–ª–∞—Å—Ç—å –∫–ª–∏–∫–∞ –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ */
            #moderatorSignature {
                padding: 5px 10px;
                display: inline-block;
                margin: 5px 0;
            }
        }
        
        @media (max-width: 480px) {
            .home-header h1 {
                font-size: 24px !important;
            }
            
            .logo {
                font-size: 40px !important;
            }
            
            .card {
                padding: 15px !important;
                margin: 10px !important;
            }
        }
        
        /* –ê–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
        @media (prefers-reduced-motion: no-preference) {
            .role-card:hover {
                transform: translateY(-5px) scale(1.02);
            }
        }
        
        /* –õ—É—á—à–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–µ–Ω—Å–æ—Ä–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
        .btn, .role-card, .step {
            -webkit-tap-highlight-color: transparent;
        }
        
        /* –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏ –¥–≤–æ–π–Ω–æ–º —Ç–∞–ø–µ */
        * {
            touch-action: manipulation;
        }
        
        /* –°–¢–ò–õ–ò –î–õ–Ø –ü–ê–ù–ï–õ–ò –ú–û–î–ï–†–ê–¢–û–†–ê */
        #moderatorPanel {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.95);
            z-index: 10000;
            display: none;
            flex-direction: column;
            padding: 20px;
        }
        
        #moderatorPanel.active {
            display: flex;
        }
        
        .moderator-header {
            background: linear-gradient(90deg, #ff9e00, #ff6d00);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 10px 10px 0 0;
            margin-bottom: 20px;
        }
        
        .moderator-header h2 {
            color: white;
            margin: 0;
            font-size: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .close-moderator {
            background: #ff416c;
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .moderator-content {
            flex: 1;
            overflow-y: auto;
            background: #1a1a2e;
            border-radius: 10px;
            padding: 20px;
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
        }
        
        @media (max-width: 768px) {
            .moderator-content {
                grid-template-columns: 1fr;
            }
        }
        
        .games-list, .moderator-controls {
            background: #222831;
            border-radius: 10px;
            padding: 15px;
            border: 2px solid #393e46;
        }
        
        .games-list h3, .moderator-controls h3 {
            color: #ff9e00;
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 16px;
        }
        
        .game-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 10px;
            border-left: 4px solid #00adb5;
        }
        
        .game-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .game-code {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            color: #00ff88;
        }
        
        .game-status {
            background: #393e46;
            color: white;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 12px;
        }
        
        .game-status.lobby { background: #00adb5; }
        .game-status.active { background: #ff9e00; }
        .game-status.finished { background: #ff416c; }
        
        .players-count {
            color: #8f8f8f;
            font-size: 12px;
        }
        
        .moderator-btn {
            display: block;
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid #ff9e00;
            color: white;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            text-align: center;
            transition: all 0.3s;
        }
        
        .moderator-btn:hover {
            background: rgba(255, 158, 0, 0.3);
            transform: translateY(-2px);
        }
        
        .moderator-btn.delete {
            border-color: #ff416c;
            color: #ff416c;
        }
        
        .moderator-btn.delete:hover {
            background: rgba(255, 65, 108, 0.3);
        }
        
        .empty-games {
            text-align: center;
            padding: 30px;
            color: #8f8f8f;
        }
        
        .empty-icon {
            font-size: 40px;
            margin-bottom: 10px;
            opacity: 0.5;
        }
        
        /* –°—Ç–∏–ª—å –¥–ª—è —Å—Å—ã–ª–∫–∏ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞ –≤ —Ñ—É—Ç–µ—Ä–µ */
        .moderator-link {
            color: #00ff88;
            text-decoration: underline;
            cursor: pointer;
            padding: 2px 5px;
            border-radius: 3px;
            transition: all 0.3s;
            display: inline-block;
            margin: 5px 0;
        }
        
        .moderator-link:hover {
            background: rgba(0, 255, 136, 0.2);
        }
    </style>
</head>
<body class="home-page">
    <div class="container">
        <header class="home-header">
            <div class="logo" style="font-size: 48px; animation: bounce 2s infinite;">üéì</div>
            <h1 style="font-size: 36px; margin: 10px 0 5px 0;">–û–ì–≠ –ö–ê–•–£–¢</h1>
            <p class="subtitle" style="color: #8f8f8f; font-size: 16px; margin-bottom: 30px;">
                –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –û–ì–≠ 2025 –ø–æ —Ä—É—Å—Å–∫–æ–º—É —è–∑—ã–∫—É
            </p>
        </header>

        <div class="stats-grid" style="
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 30px 0;
        ">
            <div class="stat-item" style="
                background: rgba(0, 173, 181, 0.1);
                padding: 20px;
                border-radius: 10px;
                text-align: center;
                border: 1px solid rgba(0, 173, 181, 0.3);
            ">
                <div class="stat-icon" style="font-size: 32px; margin-bottom: 10px;">üìö</div>
                <h4 style="margin: 0 0 5px 0; color: white;">15+ –∑–∞–¥–∞–Ω–∏–π</h4>
                <p style="margin: 0; color: #8f8f8f; font-size: 14px;">–ò–∑ –¥–µ–º–æ–≤–µ—Ä—Å–∏–∏ –û–ì–≠ 2025</p>
            </div>
            <div class="stat-item" style="
                background: rgba(67, 97, 238, 0.1);
                padding: 20px;
                border-radius: 10px;
                text-align: center;
                border: 1px solid rgba(67, 97, 238, 0.3);
            ">
                <div class="stat-icon" style="font-size: 32px; margin-bottom: 10px;">‚ö°</div>
                <h4 style="margin: 0 0 5px 0; color: white;">–†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è</h4>
                <p style="margin: 0; color: #8f8f8f; font-size: 14px;">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</p>
            </div>
            <div class="stat-item" style="
                background: rgba(114, 9, 183, 0.1);
                padding: 20px;
                border-radius: 10px;
                text-align: center;
                border: 1px solid rgba(114, 9, 183, 0.3);
            ">
                <div class="stat-icon" style="font-size: 32px; margin-bottom: 10px;">üì±</div>
                <h4 style="margin: 0 0 5px 0; color: white;">–ú–æ–±–∏–ª—å–Ω—ã–π</h4>
                <p style="margin: 0; color: #8f8f8f; font-size: 14px;">–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤</p>
            </div>
            <div class="stat-item" style="
                background: rgba(76, 201, 240, 0.1);
                padding: 20px;
                border-radius: 10px;
                text-align: center;
                border: 1px solid rgba(76, 201, 240, 0.3);
            ">
                <div class="stat-icon" style="font-size: 32px; margin-bottom: 10px;">üë•</div>
                <h4 style="margin: 0 0 5px 0; color: white;">–ë–µ–∑–ª–∏–º–∏—Ç–Ω–æ</h4>
                <p style="margin: 0; color: #8f8f8f; font-size: 14px;">–ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ –∏–≥—Ä–æ–∫–æ–≤</p>
            </div>
        </div>

        <div class="role-selection" style="
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin: 40px 0;
        ">
            <div class="role-card teacher-card" style="
                background: linear-gradient(135deg, rgba(67, 97, 238, 0.2), rgba(58, 12, 163, 0.2));
                padding: 25px;
                border-radius: 15px;
                border: 2px solid #4361ee;
                transition: all 0.3s;
            ">
                <div class="role-icon" style="font-size: 48px; text-align: center; margin-bottom: 15px;">üë®‚Äçüè´</div>
                <h3 style="text-align: center; color: white; margin-bottom: 15px;">–£–ß–ò–¢–ï–õ–¨</h3>
                <p style="color: #94a3b8; line-height: 1.6; margin-bottom: 25px; text-align: center;">
                    –ó–∞–ø—É—Å–∫–∞–π—Ç–µ –∏–≥—Ä—É –Ω–∞ —Å–º–∞—Ä—Ç-–¥–æ—Å–∫–µ, —É–ø—Ä–∞–≤–ª—è–π—Ç–µ –≤–æ–ø—Ä–æ—Å–∞–º–∏, –≤–∏–¥–∏—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –æ—Ç–≤–µ—Ç–æ–≤ –∫–ª–∞—Å—Å–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.
                </p>
                <a href="teacher.html" class="btn btn-primary" style="
                    display: block;
                    padding: 15px;
                    background: linear-gradient(45deg, #4361ee, #3a0ca3);
                    color: white;
                    border: none;
                    border-radius: 10px;
                    font-size: 16px;
                    font-weight: bold;
                    text-align: center;
                    text-decoration: none;
                    cursor: pointer;
                    transition: all 0.3s;
                ">
                    <i class="fas fa-chalkboard"></i> –û–¢–ö–†–´–¢–¨ –ü–ê–ù–ï–õ–¨ –£–ü–†–ê–í–õ–ï–ù–ò–Ø
                </a>
            </div>

            <div class="role-card student-card" style="
                background: linear-gradient(135deg, rgba(76, 201, 240, 0.2), rgba(0, 119, 182, 0.2));
                padding: 25px;
                border-radius: 15px;
                border: 2px solid #4cc9f0;
                transition: all 0.3s;
            ">
                <div class="role-icon" style="font-size: 48px; text-align: center; margin-bottom: 15px;">üßë‚Äçüéì</div>
                <h3 style="text-align: center; color: white; margin-bottom: 15px;">–£–ß–ï–ù–ò–ö</h3>
                <p style="color: #94a3b8; line-height: 1.6; margin-bottom: 25px; text-align: center;">
                    –ü–æ–¥–∫–ª—é—á–∞–π—Ç–µ—Å—å —Å —Ç–µ–ª–µ—Ñ–æ–Ω–∞, –æ—Ç–≤–µ—á–∞–π—Ç–µ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã, –≤–∏–¥–∏—Ç–µ —Å–≤–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ —Å–æ—Ä–µ–≤–Ω—É–π—Ç–µ—Å—å —Å –æ–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∞–º–∏.
                </p>
                <a href="student.html" class="btn btn-success" style="
                    display: block;
                    padding: 15px;
                    background: linear-gradient(45deg, #4cc9f0, #0077b6);
                    color: white;
                    border: none;
                    border-radius: 10px;
                    font-size: 16px;
                    font-weight: bold;
                    text-align: center;
                    text-decoration: none;
                    cursor: pointer;
                    transition: all 0.3s;
                ">
                    <i class="fas fa-mobile-alt"></i> –ü–û–î–ö–õ–Æ–ß–ò–¢–¨–°–Ø –° –¢–ï–õ–ï–§–û–ù–ê
                </a>
            </div>
        </div>

        <div class="card mt-xl" style="
            background: rgba(30, 41, 59, 0.8);
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
        ">
            <h3 style="color: white; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                <i class="fas fa-info-circle" style="color: #4361ee;"></i> –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
            </h3>
            <div class="steps" style="
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 20px;
                margin-top: 20px;
            ">
                <div class="step" style="
                    background: rgba(255, 255, 255, 0.05);
                    padding: 15px;
                    border-radius: 10px;
                    border-left: 4px solid #4361ee;
                ">
                    <span class="step-number" style="
                        display: inline-block;
                        width: 30px;
                        height: 30px;
                        background: #4361ee;
                        color: white;
                        border-radius: 50%;
                        text-align: center;
                        line-height: 30px;
                        font-weight: bold;
                        margin-right: 10px;
                    ">1</span>
                    <p style="margin: 0; color: #94a3b8;">
                        <strong style="color: white;">–£—á–∏—Ç–µ–ª—å</strong> –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞ —Å–º–∞—Ä—Ç-–¥–æ—Å–∫–µ
                    </p>
                </div>
                <div class="step" style="
                    background: rgba(255, 255, 255, 0.05);
                    padding: 15px;
                    border-radius: 10px;
                    border-left: 4px solid #4cc9f0;
                ">
                    <span class="step-number" style="
                        display: inline-block;
                        width: 30px;
                        height: 30px;
                        background: #4cc9f0;
                        color: white;
                        border-radius: 50%;
                        text-align: center;
                        line-height: 30px;
                        font-weight: bold;
                        margin-right: 10px;
                    ">2</span>
                    <p style="margin: 0; color: #94a3b8;">
                        <strong style="color: white;">–£—á–µ–Ω–∏–∫–∏</strong> –ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è —Å —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ –ø–æ –∫–æ–¥—É –∏–≥—Ä—ã
                    </p>
                </div>
                <div class="step" style="
                    background: rgba(255, 255, 255, 0.05);
                    padding: 15px;
                    border-radius: 10px;
                    border-left: 4px solid #7209b7;
                ">
                    <span class="step-number" style="
                        display: inline-block;
                        width: 30px;
                        height: 30px;
                        background: #7209b7;
                        color: white;
                        border-radius: 50%;
                        text-align: center;
                        line-height: 30px;
                        font-weight: bold;
                        margin-right: 10px;
                    ">3</span>
                    <p style="margin: 0; color: #94a3b8;">
                        <strong style="color: white;">–í–æ–ø—Ä–æ—Å –ø–æ—è–≤–ª—è–µ—Ç—Å—è</strong> –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–∞ –¥–æ—Å–∫–µ –∏ —Ç–µ–ª–µ—Ñ–æ–Ω–∞—Ö
                    </p>
                </div>
                <div class="step" style="
                    background: rgba(255, 255, 255, 0.05);
                    padding: 15px;
                    border-radius: 10px;
                    border-left: 4px solid #f72585;
                ">
                    <span class="step-number" style="
                        display: inline-block;
                        width: 30px;
                        height: 30px;
                        background: #f72585;
                        color: white;
                        border-radius: 50%;
                        text-align: center;
                        line-height: 30px;
                        font-weight: bold;
                        margin-right: 10px;
                    ">4</span>
                    <p style="margin: 0; color: #94a3b8;">
                        <strong style="color: white;">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</strong> –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞
                    </p>
                </div>
            </div>
        </div>

        <footer class="home-footer" style="
            text-align: center;
            padding: 30px 20px;
            margin-top: 40px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: #64748b;
            font-size: 14px;
        ">
            <p>–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫ –û–ì–≠ 2025 –ø–æ —Ä—É—Å—Å–∫–æ–º—É —è–∑—ã–∫—É | –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Firebase</p>
            <div class="tech-stack" style="
                display: flex;
                justify-content: center;
                gap: 15px;
                margin: 15px 0;
                flex-wrap: wrap;
            ">
                <span class="tech-item" style="
                    background: rgba(255, 255, 255, 0.05);
                    padding: 5px 10px;
                    border-radius: 20px;
                    font-size: 12px;
                ">
                    <i class="fas fa-fire"></i> Firebase
                </span>
                <span class="tech-item" style="
                    background: rgba(255, 255, 255, 0.05);
                    padding: 5px 10px;
                    border-radius: 20px;
                    font-size: 12px;
                ">
                    <i class="fab fa-html5"></i> HTML5
                </span>
                <span class="tech-item" style="
                    background: rgba(255, 255, 255, 0.05);
                    padding: 5px 10px;
                    border-radius: 20px;
                    font-size: 12px;
                ">
                    <i class="fab fa-js"></i> JavaScript
                </span>
                <span class="tech-item" style="
                    background: rgba(255, 255, 255, 0.05);
                    padding: 5px 10px;
                    border-radius: 20px;
                    font-size: 12px;
                ">
                    <i class="fas fa-cloud"></i> Cloud Storage
                </span>
            </div>
            <p class="mt-md" style="margin-top: 15px;">
                ¬© 2026 –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫ –û–ì–≠. 
                <span id="moderatorSignature" class="moderator-link">
                    <i class="fas fa-user-shield"></i> –†–µ–∂–∏–º –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞
                </span>
            </p>
            <p style="color: #8f8f8f; font-size: 12px; margin-top: 10px;">
                –î–ª—è –¥–æ—Å—Ç—É–ø–∞ –≤–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å: <code style="color: #00ff88;">JojoTop1</code>
            </p>
        </footer>
    </div>

    <!-- –ü–ê–ù–ï–õ–¨ –ú–û–î–ï–†–ê–¢–û–†–ê (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç–∞) -->
    <div id="moderatorPanel">
        <div class="moderator-header">
            <h2><i class="fas fa-user-shield"></i> –ü–ê–ù–ï–õ–¨ –ê–î–ú–ò–ù–ò–°–¢–†–ê–¢–û–†–ê</h2>
            <button class="close-moderator" onclick="closeModeratorPanel()">√ó</button>
        </div>
        
        <div class="moderator-content">
            <div class="games-list">
                <h3>üéÆ –ê–ö–¢–ò–í–ù–´–ï –ò–ì–†–´</h3>
                <div id="moderatorGamesList">
                    <div class="empty-games">
                        <div class="empty-icon">üéÆ</div>
                        <p>–ê–∫—Ç–∏–≤–Ω—ã—Ö –∏–≥—Ä –Ω–µ—Ç</p>
                    </div>
                </div>
            </div>
            
            <div class="moderator-controls">
                <h3>‚öôÔ∏è –£–ü–†–ê–í–õ–ï–ù–ò–ï</h3>
                <button class="moderator-btn" onclick="reloadGamesList()">
                    üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫
                </button>
                <button class="moderator-btn" onclick="viewAllPlayers()">
                    üë• –í—Å–µ –∏–≥—Ä–æ–∫–∏
                </button>
                <button class="moderator-btn" onclick="checkBadNicknames()">
                    üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∏–∫–∏
                </button>
                <button class="moderator-btn" onclick="clearOldGames()">
                    üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∏–≥—Ä—ã
                </button>
                <button class="moderator-btn delete" onclick="logoutModerator()">
                    üö™ –í—ã–π—Ç–∏ –∏–∑ —Ä–µ–∂–∏–º–∞
                </button>
            </div>
        </div>
    </div>

    <!-- Firebase config -->
    <script src="firebase-config.js"></script>

    <script>
        // –ú–û–î–ï–†–ê–¢–û–†–°–ö–ê–Ø –°–ò–°–¢–ï–ú–ê
        const moderatorPassword = "JojoTop1";
        let moderatorLoggedIn = false;
        let gamesListener = null;
        
        // –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –ª–æ–≥–æ—Ç–∏–ø–∞
        const logo = document.querySelector('.logo');
        if (logo) {
            setInterval(() => {
                logo.style.transform = 'rotate(5deg)';
                setTimeout(() => {
                    logo.style.transform = 'rotate(-5deg)';
                }, 1000);
                setTimeout(() => {
                    logo.style.transform = 'rotate(0deg)';
                }, 2000);
            }, 5000);
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ –∫–Ω–æ–ø–∫—É –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞
        document.getElementById('moderatorSignature').addEventListener('click', function() {
            if (moderatorLoggedIn) {
                // –ï—Å–ª–∏ —É–∂–µ –∑–∞–ª–æ–≥–∏–Ω–µ–Ω, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª—å
                document.getElementById('moderatorPanel').classList.add('active');
                loadGamesList();
            } else {
                // –ï—Å–ª–∏ –Ω–µ—Ç, –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –ø–∞—Ä–æ–ª—å
                showModeratorLogin();
            }
        });
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –æ–∫–Ω–æ –≤—Ö–æ–¥–∞ –¥–ª—è –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞
        function showModeratorLogin() {
            const password = prompt("üîß –í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:");
            if (password === moderatorPassword) {
                moderatorLoggedIn = true;
                document.getElementById('moderatorPanel').classList.add('active');
                loadGamesList();
                showNotification("‚úÖ –í—ã –≤–æ—à–ª–∏ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä");
            } else if (password !== null) {
                alert("‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!");
            }
        }
        
        // –ó–∞–∫—Ä—ã—Ç—å –ø–∞–Ω–µ–ª—å –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞
        function closeModeratorPanel() {
            document.getElementById('moderatorPanel').classList.remove('active');
        }
        
        // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∏–≥—Ä
        function loadGamesList() {
            if (!window.db) {
                console.error("Firebase –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω");
                return;
            }
            
            // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–ª—É—à–∞—Ç–µ–ª—è
            if (gamesListener) {
                gamesListener();
            }
            
            // –°–ª—É—à–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∏–≥—Ä–∞—Ö
            gamesListener = db.ref('games').on('value', snapshot => {
                const games = snapshot.val();
                updateGamesListUI(games);
            });
        }
        
        // –û–±–Ω–æ–≤–∏—Ç—å UI —Å–ø–∏—Å–∫–∞ –∏–≥—Ä
        function updateGamesListUI(games) {
            const gamesList = document.getElementById('moderatorGamesList');
            
            if (!games || Object.keys(games).length === 0) {
                gamesList.innerHTML = `
                    <div class="empty-games">
                        <div class="empty-icon">üéÆ</div>
                        <p>–ê–∫—Ç–∏–≤–Ω—ã—Ö –∏–≥—Ä –Ω–µ—Ç</p>
                    </div>
                `;
                return;
            }
            
            let html = '';
            
            Object.entries(games).forEach(([gameId, gameData]) => {
                const gameCode = gameId.replace('game_', '');
                const playersCount = gameData.players ? Object.keys(gameData.players).length : 0;
                const status = gameData.status || 'unknown';
                const createdTime = gameData.created ? new Date(gameData.created).toLocaleTimeString() : '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –∏–≥—Ä—ã
                let statusText = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
                let statusClass = '';
                
                switch(status) {
                    case 'lobby':
                        statusText = '–õ–æ–±–±–∏';
                        statusClass = 'lobby';
                        break;
                    case 'question_active':
                        statusText = '–í–æ–ø—Ä–æ—Å –∞–∫—Ç–∏–≤–µ–Ω';
                        statusClass = 'active';
                        break;
                    case 'finished':
                        statusText = '–ó–∞–≤–µ—Ä—à–µ–Ω–∞';
                        statusClass = 'finished';
                        break;
                    default:
                        statusText = status;
                }
                
                html += `
                    <div class="game-item">
                        <div class="game-info">
                            <div class="game-code">${gameCode}</div>
                            <span class="game-status ${statusClass}">${statusText}</span>
                        </div>
                        <div class="players-count">
                            üë• –ò–≥—Ä–æ–∫–æ–≤: ${playersCount} | üïê –°–æ–∑–¥–∞–Ω–∞: ${createdTime}
                        </div>
                        <div style="margin-top: 10px; display: flex; gap: 8px;">
                            <button class="moderator-btn" onclick="viewGamePlayers('${gameId}')" 
                                    style="padding: 6px 12px; font-size: 12px;">
                                üëÄ –ò–≥—Ä–æ–∫–∏
                            </button>
                            <button class="moderator-btn delete" onclick="deleteGame('${gameId}')" 
                                    style="padding: 6px 12px; font-size: 12px;">
                                üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
                            </button>
                        </div>
                    </div>
                `;
            });
            
            gamesList.innerHTML = html;
        }
        
        // –ü—Ä–æ—Å–º–æ—Ç—Ä –∏–≥—Ä–æ–∫–æ–≤ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∏–≥—Ä–µ
        function viewGamePlayers(gameId) {
            if (!gameId) return;
            
            db.ref(`games/${gameId}/players`).once('value').then(snapshot => {
                const players = snapshot.val();
                if (!players) {
                    alert("–í —ç—Ç–æ–π –∏–≥—Ä–µ –Ω–µ—Ç –∏–≥—Ä–æ–∫–æ–≤");
                    return;
                }
                
                const playerNames = Object.keys(players);
                const playerList = playerNames.map(name => `‚Ä¢ ${name} (${players[name].device || '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'})`).join('\n');
                
                alert(`–ò–≥—Ä–æ–∫–∏ –≤ –∏–≥—Ä–µ ${gameId.replace('game_', '')}:\n\n${playerList}\n\n–í—Å–µ–≥–æ: ${playerNames.length} –∏–≥—Ä–æ–∫–æ–≤`);
            });
        }
        
        // –£–¥–∞–ª–∏—Ç—å –∏–≥—Ä—É
        function deleteGame(gameId) {
            if (!gameId) return;
            
            const gameCode = gameId.replace('game_', '');
            
            if (confirm(`–£–¥–∞–ª–∏—Ç—å –∏–≥—Ä—É ${gameCode}?\n–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!`)) {
                db.ref(`games/${gameId}`).remove()
                    .then(() => {
                        showNotification(`–ò–≥—Ä–∞ ${gameCode} —É–¥–∞–ª–µ–Ω–∞`);
                    })
                    .catch(error => {
                        alert("–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –∏–≥—Ä—ã: " + error.message);
                    });
            }
        }
        
        // –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤ –≤–æ –≤—Å–µ—Ö –∏–≥—Ä–∞—Ö
        function viewAllPlayers() {
            db.ref('games').once('value').then(snapshot => {
                const games = snapshot.val();
                if (!games) {
                    alert("–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∏–≥—Ä");
                    return;
                }
                
                let allPlayers = [];
                let html = `<h3>üë• –í—Å–µ –∏–≥—Ä–æ–∫–∏ –≤–æ –≤—Å–µ—Ö –∏–≥—Ä–∞—Ö</h3>`;
                
                Object.entries(games).forEach(([gameId, gameData]) => {
                    if (gameData.players) {
                        const gameCode = gameId.replace('game_', '');
                        const players = Object.keys(gameData.players);
                        
                        if (players.length > 0) {
                            html += `<h4>üéÆ –ò–≥—Ä–∞ ${gameCode} (${players.length} –∏–≥—Ä–æ–∫–æ–≤):</h4>`;
                            html += `<ul style="margin-left: 20px;">`;
                            
                            players.forEach(playerName => {
                                const playerData = gameData.players[playerName];
                                html += `<li>${playerName} - üì± ${playerData.device || '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'} - üéØ ${playerData.score || 0} –æ—á–∫–æ–≤</li>`;
                            });
                            
                            html += `</ul>`;
                        }
                    }
                });
                
                // –°–æ–∑–¥–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
                const modal = document.createElement('div');
                modal.style.cssText = `
                    position: fixed;
                    top: 0; left: 0; right: 0; bottom: 0;
                    background: rgba(0,0,0,0.9);
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    z-index: 10001;
                    padding: 20px;
                `;
                
                modal.innerHTML = `
                    <div style="
                        background: #1a1a2e;
                        padding: 25px;
                        border-radius: 15px;
                        max-width: 600px;
                        width: 100%;
                        max-height: 80vh;
                        overflow-y: auto;
                        border: 3px solid #ff9e00;
                    ">
                        ${html}
                        <div style="text-align: center; margin-top: 20px;">
                            <button onclick="this.parentElement.parentElement.remove()" 
                                    style="
                                        background: #ff9e00;
                                        color: white;
                                        border: none;
                                        padding: 12px 30px;
                                        border-radius: 8px;
                                        font-weight: bold;
                                        cursor: pointer;
                                    ">
                                –ó–∞–∫—Ä—ã—Ç—å
                            </button>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(modal);
            });
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∏–∫–Ω–µ–π–º—ã –Ω–∞ –Ω–µ—Ü–µ–Ω–∑—É—Ä–Ω–æ—Å—Ç—å
        function checkBadNicknames() {
            const badWords = ['—Ö—É–π', '–ø–∏–∑–¥', '–µ–±–∞–Ω', '–±–ª—è', '—Å—É–∫–∞', '–ø–∏–¥–æ—Ä', '–≥–∞–Ω–¥–æ–Ω', '–º—É–¥–∞–∫', '—É–µ–±–æ–∫'];
            
            db.ref('games').once('value').then(snapshot => {
                const games = snapshot.val();
                if (!games) return;
                
                let foundBadNames = [];
                
                Object.entries(games).forEach(([gameId, gameData]) => {
                    if (gameData.players) {
                        Object.keys(gameData.players).forEach(playerName => {
                            const lowerName = playerName.toLowerCase();
                            const badWord = badWords.find(word => lowerName.includes(word));
                            
                            if (badWord) {
                                foundBadNames.push({
                                    gameId,
                                    gameCode: gameId.replace('game_', ''),
                                    playerName,
                                    badWord
                                });
                            }
                        });
                    }
                });
                
                if (foundBadNames.length === 0) {
                    alert("‚úÖ –ù–µ—Ü–µ–Ω–∑—É—Ä–Ω—ã—Ö –Ω–∏–∫–Ω–µ–π–º–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ!");
                    return;
                }
                
                let message = `‚ö†Ô∏è –ù–∞–π–¥–µ–Ω–æ ${foundBadNames.length} –Ω–µ—Ü–µ–Ω–∑—É—Ä–Ω—ã—Ö –Ω–∏–∫–Ω–µ–π–º–æ–≤:\n\n`;
                
                foundBadNames.forEach((item, index) => {
                    message += `${index + 1}. –ò–≥—Ä–∞ ${item.gameCode}: "${item.playerName}" (—Å–ª–æ–≤–æ: "${item.badWord}")\n`;
                });
                
                message += "\n–£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏?";
                
                if (confirm(message)) {
                    foundBadNames.forEach(item => {
                        db.ref(`games/${item.gameId}/players/${item.playerName}`).remove();
                    });
                    alert(`–£–¥–∞–ª–µ–Ω–æ ${foundBadNames.length} –Ω–µ—Ü–µ–Ω–∑—É—Ä–Ω—ã—Ö –Ω–∏–∫–Ω–µ–π–º–æ–≤`);
                }
            });
        }
        
        // –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∏–≥—Ä—ã (—Å—Ç–∞—Ä—à–µ 24 —á–∞—Å–æ–≤)
        function clearOldGames() {
            const confirmClear = confirm("–£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∏–≥—Ä—ã —Å—Ç–∞—Ä—à–µ 24 —á–∞—Å–æ–≤?\n–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!");
            if (!confirmClear) return;
            
            const now = Date.now();
            const oneDayAgo = now - (24 * 60 * 60 * 1000);
            
            db.ref('games').once('value').then(snapshot => {
                const games = snapshot.val();
                if (!games) return;
                
                let deletedCount = 0;
                const promises = [];
                
                Object.entries(games).forEach(([gameId, gameData]) => {
                    if (gameData.created && gameData.created < oneDayAgo) {
                        promises.push(
                            db.ref(`games/${gameId}`).remove()
                                .then(() => deletedCount++)
                        );
                    }
                });
                
                Promise.all(promises).then(() => {
                    alert(`‚úÖ –£–¥–∞–ª–µ–Ω–æ ${deletedCount} —Å—Ç–∞—Ä—ã—Ö –∏–≥—Ä`);
                    showNotification(`–£–¥–∞–ª–µ–Ω–æ ${deletedCount} —Å—Ç–∞—Ä—ã—Ö –∏–≥—Ä`);
                });
            });
        }
        
        // –í—ã–π—Ç–∏ –∏–∑ —Ä–µ–∂–∏–º–∞ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞
        function logoutModerator() {
            moderatorLoggedIn = false;
            if (gamesListener) {
                gamesListener();
                gamesListener = null;
            }
            closeModeratorPanel();
            showNotification("–í—ã –≤—ã—à–ª–∏ –∏–∑ —Ä–µ–∂–∏–º–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞");
        }
        
        // –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∏–≥—Ä
        function reloadGamesList() {
            loadGamesList();
            showNotification("–°–ø–∏—Å–æ–∫ –∏–≥—Ä –æ–±–Ω–æ–≤–ª–µ–Ω");
        }
        
        // –£—Ç–∏–ª–∏—Ç—ã
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #ff9e00;
                color: black;
                padding: 12px 20px;
                border-radius: 8px;
                font-weight: bold;
                z-index: 10000;
                animation: slideIn 0.3s ease;
                box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }
        
        // –ê–Ω–∏–º–∞—Ü–∏–∏
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
            @keyframes bounce {
                0%, 100% { transform: translateY(0); }
                50% { transform: translateY(-10px); }
            }
        `;
        document.head.appendChild(style);
        
        // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å—ã –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
        if ('ontouchstart' in window) {
            document.querySelectorAll('.role-card, .btn').forEach(element => {
                element.addEventListener('touchstart', function() {
                    this.style.opacity = '0.8';
                });
                element.addEventListener('touchend', function() {
                    this.style.opacity = '1';
                });
            });
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ Escape –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª–∫–∏
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeModeratorPanel();
            }
        });
    </script>
</body>
</html>
